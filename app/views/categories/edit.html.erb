<!-- EDIT CATEGORY PAGE: Edit Existing Category -->
<main class="edit-category-page">
  
  <!-- HEADER SECTION: Page Header -->
  <header class="edit-category-header">
    <div class="edit-category-header-container">
      <div class="edit-category-header-content">
        
        <!-- HEADER LEFT: Title and Description -->
        <div class="edit-category-header-left">
          <h1 class="edit-category-header-title">Edit Category</h1>
          <p class="edit-category-header-subtitle">Modify the category "<%= @category.name %>"</p>
        </div>
        
        <!-- HEADER RIGHT: Back Button -->
        <div class="edit-category-header-right">
          <a href="/categories" class="edit-category-back-button">
            <svg class="edit-category-back-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            Back to Categories
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- EDIT CATEGORY CONTENT: Form -->
  <div class="edit-category-content">
    <div class="edit-category-container">
      
      <!-- EDIT CATEGORY FORM: Modify Category Form -->
      <div class="edit-category-form-container">
        <div class="edit-category-form-card">
          
          <form action="/categories/<%= @category.id %>" method="POST" class="edit-category-form">
            <input type="hidden" name="_method" value="PATCH">
            <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
            
            <!-- CATEGORY NAME -->
            <div class="form-group">
              <label for="category_name" class="form-label">Category Name *</label>
              <input type="text" 
                     id="category_name" 
                     name="category[name]" 
                     class="form-input" 
                     value="<%= @category.name %>"
                     placeholder="e.g., Groceries, Entertainment, Transport"
                     required>
              <p class="form-help">Choose a descriptive name that clearly identifies this spending category.</p>
            </div>
            
            <!-- PARENT CATEGORY -->
            <div class="form-group">
              <label for="category_parent_id" class="form-label">Parent Category</label>
              <select id="category_parent_id" name="category[parent_id]" class="form-select">
                <option value="">No Parent (Top Level Category)</option>
                <% current_user.categories.where(parent_id: nil).where.not(id: @category.id).order(:name).each do |parent| %>
                  <option value="<%= parent.id %>" <%= 'selected' if @category.parent_id == parent.id %>><%= parent.name %></option>
                <% end %>
              </select>
              <p class="form-help">Leave empty for a top-level category, or select a parent to create a subcategory.</p>
            </div>
            
            <!-- CATEGORY INFO -->
            <div class="category-info-display">
              <div class="category-info-item">
                <span class="category-info-label">Created:</span>
                <span class="category-info-value"><%= @category.created_at.strftime("%B %d, %Y") %></span>
              </div>
              <div class="category-info-item">
                <span class="category-info-label">Last Updated:</span>
                <span class="category-info-value"><%= @category.updated_at.strftime("%B %d, %Y") %></span>
              </div>
              <% if @category.children.any? %>
                <div class="category-info-item">
                  <span class="category-info-label">Subcategories:</span>
                  <span class="category-info-value"><%= @category.children.count %></span>
                </div>
              <% end %>
              <% if @category.transactions.any? %>
                <div class="category-info-item">
                  <span class="category-info-label">Transactions:</span>
                  <span class="category-info-value"><%= @category.transactions.count %></span>
                </div>
              <% end %>
            </div>
            
            <!-- FORM ACTIONS -->
            <div class="form-actions">
              <a href="/categories" class="btn-secondary">Cancel</a>
              <button type="submit" class="btn-primary">Update Category</button>
            </div>
          </form>
          
        </div>
      </div>
      
      <!-- INFO PANEL: Category Management Tips -->
      <div class="edit-category-info-panel">
        <div class="edit-category-info-header">
          <h3 class="edit-category-info-title">Category Management Tips</h3>
        </div>
        <div class="edit-category-info-content">
          
          <div class="edit-category-info-item">
            <div class="edit-category-info-icon">
              <svg class="edit-category-info-svg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <div class="edit-category-info-text">
              <h4 class="edit-category-info-subtitle">Safe Editing</h4>
              <p class="edit-category-info-description">You can safely rename categories. The AI will continue to use them for categorization.</p>
            </div>
          </div>
          
          <div class="edit-category-info-item">
            <div class="edit-category-info-icon">
              <svg class="edit-category-info-svg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8v-2a2 2 0 012-2h2a2 2 0 012 2v2m-6 8a2 2 0 002 2h2a2 2 0 002-2m0 0V6a2 2 0 012-2h2a2 2 0 012 2v10a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
              </svg>
            </div>
            <div class="edit-category-info-text">
              <h4 class="edit-category-info-subtitle">Parent Changes</h4>
              <p class="edit-category-info-description">Changing a category's parent will reorganize your category hierarchy. Make sure this makes sense for your organization.</p>
            </div>
          </div>
          
          <div class="edit-category-info-item">
            <div class="edit-category-info-icon">
              <svg class="edit-category-info-svg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2zm0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
              </svg>
            </div>
            <div class="edit-category-info-text">
              <h4 class="edit-category-info-subtitle">AI Impact</h4>
              <p class="edit-category-info-description">The AI will use the updated category name for future transaction categorization. Existing transactions keep their current categories.</p>
            </div>
          </div>
          
        </div>
      </div>
      
    </div>
  </div>
</main>
