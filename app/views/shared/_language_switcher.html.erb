<div class="<%= local_assigns[:fixed_position] ? 'inline-block text-left' : 'relative inline-block text-left' %>" data-controller="language-switcher">
  <div class="relative">
    <!-- Language switcher button -->
    <button type="button" 
            class="inline-flex items-center justify-center px-3 py-2 rounded-lg border border-gray-600 bg-gray-900 text-sm font-medium text-white hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer transition-colors duration-200"
            data-language-switcher-target="button"
            data-action="click->language-switcher#toggle"
            aria-expanded="false"
            aria-haspopup="true">
      <span class="text-white">
        <%= I18n.locale == :es ? 'ES' : 'EN' %>
      </span>
      <svg class="-mr-1 ml-1 h-4 w-4 text-white" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
      </svg>
    </button>
    
    <!-- Dropdown menu - minimal width to fit content exactly -->
    <div class="hidden absolute top-full right-0 mt-1 bg-gray-900 border border-gray-600 rounded-md shadow-lg z-[9999] whitespace-nowrap" 
         data-language-switcher-target="menu">
      <div class="py-1">
        <% 
          current_path = request.path
          path_without_locale = current_path.gsub(/^\/[a-z]{2}(?=\/|$)/, '')
          path_without_locale = "/#{path_without_locale}" unless path_without_locale.start_with?('/')
          path_without_locale = "/" if path_without_locale.blank?
        %>
        
        <% if I18n.locale == :en %>
          <!-- Show Spanish option when English is selected -->
          <a href="/es<%= path_without_locale %>" 
             class="text-white hover:bg-gray-800 block px-3 py-2 text-sm text-center transition-colors duration-200">
            ES
          </a>
        <% else %>
          <!-- Show English option when Spanish is selected -->
          <a href="/en<%= path_without_locale %>" 
             class="text-white hover:bg-gray-800 block px-3 py-2 text-sm text-center transition-colors duration-200">
            EN
          </a>
        <% end %>
      </div>
    </div>
  </div>
</div>
