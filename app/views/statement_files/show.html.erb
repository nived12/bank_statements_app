<h1>Statement file</h1>

<p>
  Bank account: <%= @statement_file.bank_account&.display_name %><br/>
  Status: <%= @statement_file.status %><br/>
  Processed at: <%= @statement_file.processed_at %>
</p>

<% if @statement_file.file.attached? %>
  <p>
    <%= link_to "Download file", rails_blob_path(@statement_file.file, disposition: "attachment") %>
  </p>
<% else %>
  <p>No file attached.</p>
<% end %>

<% if @statement_file.parsed_json.present? && @statement_file.parsed_json["transactions"].present? %>
  <h2>Transactions</h2>
  <table border="1" cellpadding="6">
    <thead>
      <tr>
        <th>Date</th>
        <th>Description</th>
        <th>Amount</th>
        <th>Type</th>
        <th>Bank Entry</th>
      </tr>
    </thead>
    <tbody>
      <% @statement_file.parsed_json["transactions"].each do |t| %>
        <tr>
          <td><%= t["date"] %></td>
          <td><%= t["description"] %></td>
          <td><%= t["amount"] %></td>
          <td><%= t["type"] %></td>
          <td><%= t["bank_entry_type"] %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>
